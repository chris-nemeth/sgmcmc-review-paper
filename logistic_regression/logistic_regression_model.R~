## logLik = function(params, data) {
##     yest = 1 / (1 + tf$exp( - tf$einsum("ij,j->i", data$X, params$beta)))
##     logLik = tf$reduce_sum(data$y * tf$log(yest) + (1 - data$y) * tf$log(1 - yest))
##     return(logLik)
## }

logLik = function(params, dataset) {
    logLik = tf$reduce_sum(dataset$y * tf$squeeze(tf$matmul(dataset$X, params$beta)) - tf$log(1 + tf$exp(tf$squeeze(tf$matmul(dataset$X, params$beta)))))
    return(logLik)
}

logPrior = function(params) {
    d = tf$shape(params$beta)[1L]
    mu0 = tf$zeros(d)
    Sigma0 = 10 * tf$ones(d)
    priorDistn = tf$distributions$MultivariateNormalDiag(mu0, Sigma0)
    logPrior = tf$reduce_sum(priorDistn$log_prob(params$beta))
    return(logPrior)
}


