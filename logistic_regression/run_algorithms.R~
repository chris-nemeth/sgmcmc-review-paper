source("dataLookup.R")
source("../../mcmc/sgmcmc/lreg.R")
library(sgmcmc)

# Change to tuned values
h = 4e-7

jobID = as.numeric(commandArgs(trailing = T))
# Get dataset, seed and dimension info given job id (from dataLookup.R)
inputs = lookupData(jobID)
simConsts = getSimConsts()

dataset = list("X" = inputs$X, "y" = inputs$y)
params = list("beta" = matrix(betaInit(inputs$d),nrow=inputs$d))

start_time <- Sys.time()
output = sgld(logLik, dataset, params, h, logPrior, simConsts$minibatchSize, nIters = 10^5L, verbose=FALSE)
end_time <- Sys.time()
total_time <-  end_time - start_time
print(total_time)

lookupSave(output$beta[(9*10^4+1):(10^5),,], inputs, "sgld", jobID)
saveTime(total_time, inputs, "sgld", jobID) 

