source("dataLookup.R")
library(rstan)

rstan_options(auto_write = TRUE)
options(mc.cores = 1)

jobID = as.numeric(commandArgs(trailing = T))
# Get dataset, seed and dimension info given job id (from dataLookup.R)
inputs = lookupData(jobID)
# Get prior variance for beta parameters
betaVar = betaPrior(inputs$d)
simConsts = getSimConsts()

dataset = list("N" = simConsts$N, "X" = inputs$X, "y" = inputs$y, "d" = inputs$d, "Sigma0" = betaVar)
start_time <- Sys.time()
output = stan("../../mcmc/stan/lreg.stan", data = dataset, iter = 2000, chains = 1)
end_time <- Sys.time()
total_time <-  end_time - start_time
print(total_time)

stanSave(output, inputs, jobID)
saveTime(total_time, inputs, "stan", jobID) 
